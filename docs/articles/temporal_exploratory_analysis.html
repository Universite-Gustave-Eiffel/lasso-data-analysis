<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Temporal exploratory analysis • LASSO</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Temporal exploratory analysis">
<meta property="og:description" content="LASSO">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">LASSO</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Analysis_Database_overview.html">[Analysis] Database overview</a>
    </li>
    <li>
      <a href="../articles/Analysis_Hourly_tag_repartition.html">[Analysis] Time distribution analysis</a>
    </li>
    <li>
      <a href="../articles/Analysis_Tags_around_sunrise.html">[Analysis] Sunrise analysis</a>
    </li>
    <li>
      <a href="../articles/Analysis_Tags_around_sunset.html">[Analysis] Sunset analysis</a>
    </li>
    <li>
      <a href="../articles/Analysis_Temporal_attributes.html">[Analysis] Temporal attributes analysis</a>
    </li>
    <li>
      <a href="../articles/Analysis_Weather_analysis.html">[Analysis] Weather analysis</a>
    </li>
    <li>
      <a href="../articles/crowdsourced_acoustic_data_analysis_with_foss4g_2022.html">Crowdsourced acoustic open data analysis with FOSS4G tools</a>
    </li>
    <li>
      <a href="../articles/temporal_exploratory_analysis.html">Temporal exploratory analysis</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Temporal exploratory analysis</h1>
                        <h4 data-toc-skip class="author">Nicolas Roelandt</h4>
            <address class="author_afil">
      AME, Univ. Gustave Eiffel, IFSTTAR, F-69675 Bron, France<br><h4 data-toc-skip class="author">Pierre Aumond</h4>
            <address class="author_afil">
      UMRAE, Univ Gustave Eiffel, IFSTTAR, CEREMA, F-44344 Bouguenais, France<br><h4 data-toc-skip class="author">Ludovic Moisan</h4>
            <address class="author_afil">
      UMRAE, Univ Gustave Eiffel, IFSTTAR, CEREMA, F-44344 Bouguenais, France<br><h4 data-toc-skip class="date">2022-06-29</h4>
      
      
      <div class="hidden name"><code>temporal_exploratory_analysis.Rmd</code></div>

    </address>
</address>
</address>
</div>

    
    
<div class="section level2" number="1">
<h2 id="replication">
<span class="header-section-number">1</span> Replication<a class="anchor" aria-label="anchor" href="#replication"></a>
</h2>
<div class="section level3" number="1.1">
<h3 id="get-the-source-code">
<span class="header-section-number">1.1</span> Get the source code<a class="anchor" aria-label="anchor" href="#get-the-source-code"></a>
</h3>
<p>As the analysis part of project as been treated as R package, there is several ways
to get the code source:</p>
<ul>
<li>using git</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> clone https://github.com/nicolas-roelandt/lasso-data-analysis</span></code></pre></div>
<ul>
<li>using R and the <a href="https://remotes.r-lib.org/" class="external-link">remotes package</a>:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># We suggest to use the remotes package</span>
<span class="co"># install.packages("remotes")</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"nicolas-roelandt/lasso-data-analysis"</span><span class="op">)</span></code></pre></div>
<ul>
<li>download as a <a href="https://github.com/nicolas-roelandt/lasso-data-analysis/archive/refs/heads/main.zip" class="external-link">zip archive</a>
</li>
</ul>
</div>
<div class="section level3" number="1.2">
<h3 id="setup">
<span class="header-section-number">1.2</span> Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h3>
<p>This analysis use several packages that you’ll need to install beforehand.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Package list</span>
<span class="va">pkgs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"RPostgreSQL"</span>,
          <span class="st">"DBI"</span>,
          <span class="st">"sf"</span>,
          <span class="st">"dplyr"</span>,
          <span class="st">"purrr"</span>,
          <span class="st">"ggplot2"</span>,
          <span class="st">"scales"</span>,
          <span class="st">"lubridate"</span>,
          <span class="st">"hydroTSM"</span>,
          <span class="st">"suncalc"</span>,
          <span class="st">"xfun"</span><span class="op">)</span>

<span class="co"># Packages installation from CRAN</span>
<span class="co"># We suggest to use the remotes package to install required packages</span>
<span class="co"># Already installed packages won't be reinstalled</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_cran.html" class="external-link">install_cran</a></span><span class="op">(</span><span class="va">pkgs</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Database connection</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tomoakin/RPostgreSQL" class="external-link">RPostgreSQL</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dbi.r-dbi.org" class="external-link">DBI</a></span><span class="op">)</span>
<span class="va">drv</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDriver.html" class="external-link">dbDriver</a></span><span class="op">(</span><span class="st">"PostgreSQL"</span><span class="op">)</span>

<span class="co"># Data handling</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://purrr.tidyverse.org" class="external-link">purrr</a></span><span class="op">)</span>

<span class="co"># Graphs</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org" class="external-link">scales</a></span><span class="op">)</span>

<span class="co"># time / date handling</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hzambran/hydroTSM" class="external-link">hydroTSM</a></span><span class="op">)</span>

<span class="co"># Get sun rise time</span>
<span class="co">## install.packages("suncalc")</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/datastorm-open/suncalc" class="external-link">suncalc</a></span><span class="op">)</span>

<span class="co"># data cache handling</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/yihui/xfun" class="external-link">xfun</a></span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3" number="1.3">
<h3 id="database-connection">
<span class="header-section-number">1.3</span> Database connection<a class="anchor" aria-label="anchor" href="#database-connection"></a>
</h3>
<p>We provide the database connection parameters to make it easier to replicate and update.
However, this database is not publicly available.
Those parameters are here to help you connect with your own database (see the
<a href="https://github.com/nicolas-roelandt/lasso-data-analysis#how-to-reproduce=" class="external-link">README</a> for more information on that aspect.</p>
<p>To help replication, the results of SQL queries have been cached (using the
<code><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">xfun::cache_rds</a></code> function) and are available as <code>.rds</code> files inside the github repository:
<a href="https://github.com/nicolas-roelandt/lasso-data-analysis/tree/FOSS4G2022/vignettes/temporal_exploratory_analysis_cache/html" class="external-link uri">https://github.com/nicolas-roelandt/lasso-data-analysis/tree/FOSS4G2022/vignettes/temporal_exploratory_analysis_cache/html</a></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">con</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span>
<span class="va">drv</span>,
dbname <span class="op">=</span><span class="st">"noisecapture"</span>,
host <span class="op">=</span> <span class="st">"lassopg.ifsttar.fr"</span>, <span class="co">#server IP or hostname</span>
port <span class="op">=</span> <span class="fl">5432</span>, <span class="co">#Port on which we ran the proxy</span>
user<span class="op">=</span><span class="st">"noisecapture"</span>,
<span class="co"># password stored in .Renviron. To edit : usethis::edit_r_environ()</span>
password<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">'noisecapture_password'</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
<p>You can check your connection by requesting the tag list for example.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Tag list</span>
<span class="va">tag_list</span> <span class="op">&lt;-</span> <span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">cache_rds</a></span><span class="op">(</span><span class="op">{</span>
  <span class="va">query</span> <span class="op">&lt;-</span> <span class="st">"SELECT distinct  * FROM noisecapture_tag;"</span>
  <span class="fu">RPostgreSQL</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">con</span>,statement <span class="op">=</span> <span class="va">query</span><span class="op">)</span> 
<span class="op">}</span>,rerun <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">database</span><span class="op">)</span>

<span class="va">tag_list</span></code></pre></div>
<pre><code><span class="co">##    pk_tag       tag_name</span>
<span class="co">## 1      13        natural</span>
<span class="co">## 2      24          noisy</span>
<span class="co">## 3       2          works</span>
<span class="co">## 4       3     mechanical</span>
<span class="co">## 5       8          water</span>
<span class="co">## 6      31          crowd</span>
<span class="co">## 7      16           rail</span>
<span class="co">## 8      36     big street</span>
<span class="co">## 9      18           wind</span>
<span class="co">## 10      4       chatting</span>
<span class="co">## 11      7    air_traffic</span>
<span class="co">## 12     14        animals</span>
<span class="co">## 13     29          birds</span>
<span class="co">## 14     28  heavy vehicle</span>
<span class="co">## 15     33    two-wheeled</span>
<span class="co">## 16     21     vegetation</span>
<span class="co">## 17     22         nature</span>
<span class="co">## 18      1           test</span>
<span class="co">## 19     19           rain</span>
<span class="co">## 20     26  entertainment</span>
<span class="co">## 21      9     industrial</span>
<span class="co">## 22     32       animated</span>
<span class="co">## 23     35   small street</span>
<span class="co">## 24     12           road</span>
<span class="co">## 25     17         alarms</span>
<span class="co">## 26     20 marine_traffic</span>
<span class="co">## 27     11      footsteps</span>
<span class="co">## 28      6         indoor</span>
<span class="co">## 29     30    air-traffic</span>
<span class="co">## 30     25         silent</span>
<span class="co">## 31     15          music</span>
<span class="co">## 32     34        traffic</span>
<span class="co">## 33     27          urban</span>
<span class="co">## 34      5          human</span>
<span class="co">## 35     23      work area</span>
<span class="co">## 36     10       children</span></code></pre>
</div>
</div>
<div class="section level2" number="2">
<h2 id="data-cleaning">
<span class="header-section-number">2</span> Data cleaning<a class="anchor" aria-label="anchor" href="#data-cleaning"></a>
</h2>
<p>The data stored in the database is not useable as is.
Most of the data is not taggued, the accuraccy of the GPS position can vary, the track is too long.
So the data needs to be filtered.</p>
<p>This has been done within the database using views.
Please see the <a href="https://github.com/nicolas-roelandt/lasso-data-analysis/blob/main/scripts/03_create_views.sql" class="external-link">03_create_views.sql</a> script for more details.</p>
<p>In summary, it removes test and indoor records, filter tracks that have a duration between 5 to 900 seconds.
It also remove the tracks where the GPS accuracy was below a 20 meters threshold and that are larger than a 25 square meters area.</p>
<p>This study is focused on France so there is a spatial filtering on its boundaries.</p>
<p>The final data is stored in a view called <code>france_tracks</code> that can be called at will.</p>
<div class="section level3" number="2.1">
<h3 id="retrieve-data">
<span class="header-section-number">2.1</span> Retrieve data<a class="anchor" aria-label="anchor" href="#retrieve-data"></a>
</h3>
<div class="section level4" number="2.1.1">
<h4 id="track-information">
<span class="header-section-number">2.1.1</span> Track information<a class="anchor" aria-label="anchor" href="#track-information"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">track_info</span> <span class="op">&lt;-</span> <span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">cache_rds</a></span><span class="op">(</span><span class="op">{</span>
  <span class="va">query</span> <span class="op">&lt;-</span> <span class="st">"SELECT  pk_track, record_utc, time_length, pleasantness, noise_level, track_uuid, geog
FROM france_tracks;"</span>

 <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">con</span>,query <span class="op">=</span> <span class="va">query</span><span class="op">)</span>
<span class="op">}</span>,rerun <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">database</span><span class="op">)</span>

<span class="va">track_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Simple feature collection with 6 features and 6 fields</span>
<span class="co">## Geometry type: GEOMETRY</span>
<span class="co">## Dimension:     XY</span>
<span class="co">## Bounding box:  xmin: -0.5425126 ymin: 45.73464 xmax: 5.000842 ymax: 48.97122</span>
<span class="co">## Geodetic CRS:  WGS 84</span>
<span class="co">##   pk_track          record_utc time_length pleasantness noise_level</span>
<span class="co">## 1     1872 2017-12-14 16:20:17          62           NA       90.54</span>
<span class="co">## 2     1914 2017-09-17 17:51:52          16           75       63.59</span>
<span class="co">## 3     2127 2017-09-05 07:21:26          17          100       59.49</span>
<span class="co">## 4     2236 2018-12-07 14:19:17          13           NA       46.54</span>
<span class="co">## 5     2300 2018-11-11 20:26:18           6           NA       60.88</span>
<span class="co">## 6     2326 2018-11-12 19:04:16          41           NA       72.70</span>
<span class="co">##                             track_uuid                           geog</span>
<span class="co">## 1 f1f6d44c-1399-41fa-8cb9-8becbc43778f POLYGON ((0.6938293 47.3893...</span>
<span class="co">## 2 0acde04f-cb5e-4c4c-bbb4-412f933c3709 POLYGON ((5.000838 45.73464...</span>
<span class="co">## 3 7e508105-e57a-4223-b4b3-ddea7240099f POLYGON ((-0.5425127 47.488...</span>
<span class="co">## 4 8f1bb1ed-814a-4c04-ac01-f7447710766d POLYGON ((4.836361 45.76406...</span>
<span class="co">## 5 18c57c75-05ad-4205-96b5-e5b28580eda1      POINT (2.256505 48.95881)</span>
<span class="co">## 6 947bdf1d-d586-417d-86d9-81a1096cefb9 POLYGON ((2.275491 48.97113...</span></code></pre>
<p>Some records are not in the France metropolitan area so they need to be discarded.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Define where to save the dataset</span>
<span class="va">extraWD</span> <span class="op">&lt;-</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">"raw_data"</span><span class="op">)</span>
<span class="co"># Get some data available to anyone</span>
<span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.exists</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">extraWD</span>, <span class="st">"2020_France_metro_WGS84.geojson"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">githubURL</span> <span class="op">&lt;-</span> <span class="st">"https://github.com/nicolas-roelandt/lasso-data-analysis/raw/main/raw_data/2020_France_metro_WGS84.geojson"</span>
  <span class="fu"><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file</a></span><span class="op">(</span><span class="va">githubURL</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">extraWD</span>, <span class="st">"2020_France_metro_WGS84.geojson"</span><span class="op">)</span><span class="op">)</span>
  <span class="co">#unzip(file.path(extraWD, "2020_France_metro_WGS84.zip"), exdir = extraWD)</span>
<span class="op">}</span>
<span class="va">france_metro</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span>dsn<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">extraWD</span>, <span class="st">"2020_France_metro_WGS84.geojson"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Reading layer `2020_France_metro_WGS84' from data source </span>
<span class="co">##   `D:\Roelandt\PROJETS\InProgress\06_UMRAE\2021\lasso-data-analysis\raw_data\2020_France_metro_WGS84.geojson' </span>
<span class="co">##   using driver `GeoJSON'</span>
<span class="co">## Simple feature collection with 1 feature and 1 field</span>
<span class="co">## Geometry type: MULTIPOLYGON</span>
<span class="co">## Dimension:     XY</span>
<span class="co">## Bounding box:  xmin: -5.141277 ymin: 41.36599 xmax: 9.559961 ymax: 51.08899</span>
<span class="co">## Geodetic CRS:  WGS 84</span></code></pre>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">filtered_track_info</span> <span class="op">&lt;-</span> <span class="va">track_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_binary_pred.html" class="external-link">st_intersects</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">france_metro</span>, sparse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>5092 tracks meets the study criteria (duration, envelop area, etc.).
67 tracks where not in France’s metropolitan area.</p>
</div>
<div class="section level4" number="2.1.2">
<h4 id="tag-information">
<span class="header-section-number">2.1.2</span> Tag information<a class="anchor" aria-label="anchor" href="#tag-information"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tag_info</span> <span class="op">&lt;-</span> <span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">cache_rds</a></span><span class="op">(</span><span class="op">{</span>
  <span class="va">query</span> <span class="op">&lt;-</span> <span class="st">"SELECT ft.pk_track, tag_name FROM france_tracks as ft
INNER JOIN noisecapture_track_tag ntt ON ft.pk_track = ntt.pk_track /* Add track tags*/
INNER JOIN noisecapture_tag ntag ON ntag.pk_tag = ntt.pk_tag /* Add track tags*/;"</span>

 <span class="fu">RPostgreSQL</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">con</span>,statement <span class="op">=</span> <span class="va">query</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">pk_track</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">filtered_track_info</span><span class="op">$</span><span class="va">pk_track</span><span class="op">)</span>
<span class="op">}</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">tag_info</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##   pk_track  tag_name</span>
<span class="co">## 1     1872  chatting</span>
<span class="co">## 2     1872  children</span>
<span class="co">## 3     1872 footsteps</span>
<span class="co">## 4     1872     music</span>
<span class="co">## 5     1872      road</span>
<span class="co">## 6     1872      rail</span></code></pre>
<p>Those 5092 tracks correspond to 9482 tags as a track can have multiple tags.</p>
<p><img src="temporal_exploratory_analysis_files/figure-html/tag-histo-1.png" width="672"></p>
</div>
</div>
</div>
<div class="section level2" number="3">
<h2 id="time-repartition">
<span class="header-section-number">3</span> Time repartition<a class="anchor" aria-label="anchor" href="#time-repartition"></a>
</h2>
<div class="section level3" number="3.1">
<h3 id="all-year">
<span class="header-section-number">3.1</span> All year<a class="anchor" aria-label="anchor" href="#all-year"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_info</span> <span class="op">&lt;-</span> <span class="va">tag_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span>
    <span class="va">filtered_track_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="co"># add local hour</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>local_time <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/hour.html" class="external-link">hour</a></span><span class="op">(</span> <span class="co"># extract hour</span>
    <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">with_tz</a></span><span class="op">(</span> <span class="co"># convert to local time</span>
      <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="va">record_utc</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="co"># convert text to date</span>
      <span class="st">"Europe/Paris"</span><span class="op">)</span><span class="op">)</span>, <span class="co"># target timezone</span>
    season <span class="op">=</span> <span class="fu">hydroTSM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/hydroTSM/man/time2season.html" class="external-link">time2season</a></span><span class="op">(</span><span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/date.html" class="external-link">date</a></span><span class="op">(</span><span class="va">record_utc</span><span class="op">)</span>, out.fmt <span class="op">=</span> <span class="st">"seasons"</span>, type<span class="op">=</span><span class="st">"default"</span><span class="op">)</span><span class="op">)</span> <span class="co"># compute season</span></code></pre></div>
<pre><code><span class="co">## Joining, by = "pk_track"</span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">all_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="6%">
<col width="7%">
<col width="15%">
<col width="9%">
<col width="9%">
<col width="9%">
<col width="28%">
<col width="8%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="right">pk_track</th>
<th align="left">tag_name</th>
<th align="left">record_utc</th>
<th align="right">time_length</th>
<th align="right">pleasantness</th>
<th align="right">noise_level</th>
<th align="left">track_uuid</th>
<th align="right">local_time</th>
<th align="left">season</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1872</td>
<td align="left">chatting</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">17</td>
<td align="left">winter</td>
</tr>
<tr class="even">
<td align="right">1872</td>
<td align="left">children</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">17</td>
<td align="left">winter</td>
</tr>
<tr class="odd">
<td align="right">1872</td>
<td align="left">footsteps</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">17</td>
<td align="left">winter</td>
</tr>
<tr class="even">
<td align="right">1872</td>
<td align="left">music</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">17</td>
<td align="left">winter</td>
</tr>
<tr class="odd">
<td align="right">1872</td>
<td align="left">road</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">17</td>
<td align="left">winter</td>
</tr>
<tr class="even">
<td align="right">1872</td>
<td align="left">rail</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">17</td>
<td align="left">winter</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">occurences</span> <span class="op">&lt;-</span> <span class="va">all_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">tag_name</span>, <span class="va">local_time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"occurences"</span><span class="op">)</span>

<span class="va">occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">tag_name</th>
<th align="right">local_time</th>
<th align="right">occurences</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">0</td>
<td align="right">9</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">5</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">8</td>
<td align="right">14</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tags_hourly_repartition</span> <span class="op">&lt;-</span> <span class="va">occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>
    <span class="va">occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">local_time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">occurences</span><span class="op">)</span><span class="op">)</span>,
    by <span class="op">=</span> <span class="st">"local_time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">occurences</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">/</span> <span class="va">total</span><span class="op">)</span>

<span class="va">tags_hourly_repartition</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">tag_name</th>
<th align="right">local_time</th>
<th align="right">occurences</th>
<th align="right">total</th>
<th align="right">percentage</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">0</td>
<td align="right">9</td>
<td align="right">171</td>
<td align="right">5.2631579</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">119</td>
<td align="right">0.8403361</td>
</tr>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">3</td>
<td align="right">1</td>
<td align="right">50</td>
<td align="right">2.0000000</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">4</td>
<td align="right">1</td>
<td align="right">22</td>
<td align="right">4.5454545</td>
</tr>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">5</td>
<td align="right">1</td>
<td align="right">31</td>
<td align="right">3.2258065</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">8</td>
<td align="right">14</td>
<td align="right">116</td>
<td align="right">12.0689655</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tags_hourly_repartition</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">local_time</span>, y <span class="op">=</span> <span class="va">percentage</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"circle"</span>, size <span class="op">=</span> <span class="fl">1.5</span>, colour <span class="op">=</span> <span class="st">"#112446"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Time of the day"</span>,
    y <span class="op">=</span> <span class="st">"Percentage"</span>,
    title <span class="op">=</span> <span class="st">"Hourly repartition of tags"</span>,
    subtitle <span class="op">=</span> <span class="st">"Noicecaptures tags in metropolitan France,
    2017 - 2020"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">tag_name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="temporal_exploratory_analysis_files/figure-html/tags-hourly-repartition-graph-1.png" width="672"></p>
<div class="section level4" number="3.1.1">
<h4 id="hourly-dynamics-details">
<span class="header-section-number">3.1.1</span> Hourly dynamics, details<a class="anchor" aria-label="anchor" href="#hourly-dynamics-details"></a>
</h4>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dynamic_graphs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Repartition of"</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">" "</span>,<span class="va">tag</span><span class="op">)</span>,<span class="st">"sounds in local time"</span><span class="op">)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tags_hourly_repartition</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tag_name</span> <span class="op">==</span> <span class="va">tag</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">local_time</span>, y <span class="op">=</span> <span class="va">percentage</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"circle"</span>, size <span class="op">=</span> <span class="fl">1.5</span>, colour <span class="op">=</span> <span class="st">"#112446"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Time of the day"</span>,
    y <span class="op">=</span> <span class="st">"Percentage"</span>,
    title <span class="op">=</span> <span class="va">title</span>,
    subtitle <span class="op">=</span> <span class="st">"Noicecaptures tags in metropolitan France,
    2017 - 2020"</span>
  <span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"loess"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># smooth curve test (see span parameter to fit more to the peak before sunrise)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="co"># save graphs</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"plots/"</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>,<span class="va">title</span><span class="op">)</span>,<span class="st">".png"</span><span class="op">)</span><span class="op">)</span> 
<span class="op">}</span>

<span class="co"># Render graphs</span>
<span class="va">graphs</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">tags_hourly_repartition</span><span class="op">$</span><span class="va">tag_name</span><span class="op">)</span>, <span class="va">dynamic_graphs</span><span class="op">)</span></code></pre></div>
<p><img src="plots/Repartition_of_air_traffic_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_alarms_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_animals_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_chatting_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_children_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_footsteps_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_industrial_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_marine_traffic_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_music_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_rail_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_rain_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_road_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_vegetation_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_water_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_wind_sounds_in_local_time.png" width="1050"><img src="plots/Repartition_of_works_sounds_in_local_time.png" width="1050"></p>
</div>
</div>
<div class="section level3" number="3.2">
<h3 id="seasonal-repartition">
<span class="header-section-number">3.2</span> Seasonal repartition<a class="anchor" aria-label="anchor" href="#seasonal-repartition"></a>
</h3>
<div class="section level4" number="3.2.1">
<h4 id="animals">
<span class="header-section-number">3.2.1</span> Animals<a class="anchor" aria-label="anchor" href="#animals"></a>
</h4>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">seasonal_occurences</span> <span class="op">&lt;-</span> <span class="va">all_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">tag_name</span>, <span class="va">local_time</span>, <span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"occurences"</span><span class="op">)</span>

<span class="va">animals_seasonal_repartition</span> <span class="op">&lt;-</span> <span class="va">seasonal_occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tag_name</span> <span class="op">==</span> <span class="st">"animals"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonal_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">season</span>,<span class="st">'_'</span>,<span class="va">local_time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>
    <span class="va">seasonal_occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">local_time</span>, <span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">occurences</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonal_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">season</span>,<span class="st">'_'</span>,<span class="va">local_time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">season</span><span class="op">)</span>,
    by <span class="op">=</span> <span class="st">"seasonal_time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">occurences</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">/</span> <span class="va">total</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## `summarise()` has grouped output by 'local_time'. You can override using the</span>
<span class="co">## `.groups` argument.</span></code></pre>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">animals_seasonal_repartition</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">local_time.y</span>, <span class="op">-</span><span class="va">seasonal_time</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">tag_name</th>
<th align="right">local_time.x</th>
<th align="left">season</th>
<th align="right">occurences</th>
<th align="right">total</th>
<th align="right">percentage</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">animals</td>
<td align="right">0</td>
<td align="left">autumm</td>
<td align="right">3</td>
<td align="right">77</td>
<td align="right">3.896104</td>
</tr>
<tr class="even">
<td align="left">animals</td>
<td align="right">0</td>
<td align="left">summer</td>
<td align="right">5</td>
<td align="right">76</td>
<td align="right">6.578947</td>
</tr>
<tr class="odd">
<td align="left">animals</td>
<td align="right">1</td>
<td align="left">autumm</td>
<td align="right">1</td>
<td align="right">40</td>
<td align="right">2.500000</td>
</tr>
<tr class="even">
<td align="left">animals</td>
<td align="right">1</td>
<td align="left">summer</td>
<td align="right">3</td>
<td align="right">58</td>
<td align="right">5.172414</td>
</tr>
<tr class="odd">
<td align="left">animals</td>
<td align="right">2</td>
<td align="left">autumm</td>
<td align="right">1</td>
<td align="right">13</td>
<td align="right">7.692308</td>
</tr>
<tr class="even">
<td align="left">animals</td>
<td align="right">3</td>
<td align="left">autumm</td>
<td align="right">2</td>
<td align="right">19</td>
<td align="right">10.526316</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">animals_seasonal_repartition</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">local_time.x</span>, y <span class="op">=</span> <span class="va">percentage</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"circle"</span>, size <span class="op">=</span> <span class="fl">1.5</span>, colour <span class="op">=</span> <span class="st">"#112446"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Local time"</span>,
    y <span class="op">=</span> <span class="st">"Percentage"</span>,
    title <span class="op">=</span> <span class="st">"Seasonal occurences of animals sounds"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">season</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="temporal_exploratory_analysis_files/figure-html/animals-hourly-repartition-season-graph-1.png" width="672"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">season_graphs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Seasonal occurences of"</span>,<span class="va">tag</span>,<span class="st">"sounds"</span><span class="op">)</span>
  <span class="va">seasonal_occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tag_name</span> <span class="op">==</span> <span class="va">tag</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonal_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">season</span>,<span class="st">'_'</span>,<span class="va">local_time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>
    <span class="va">seasonal_occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">local_time</span>, <span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">occurences</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
      <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>seasonal_time <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">season</span>,<span class="st">'_'</span>,<span class="va">local_time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">season</span><span class="op">)</span>,
    by <span class="op">=</span> <span class="st">"seasonal_time"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">occurences</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">/</span> <span class="va">total</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">local_time.x</span>, y <span class="op">=</span> <span class="va">percentage</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"circle"</span>, size <span class="op">=</span> <span class="fl">1.5</span>, colour <span class="op">=</span> <span class="st">"#112446"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Local time"</span>,
    y <span class="op">=</span> <span class="st">"Percentage"</span>,
    title <span class="op">=</span> <span class="va">title</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">season</span><span class="op">)</span><span class="op">)</span>
  
  <span class="co"># save graphs</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"plots/"</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>,<span class="va">title</span><span class="op">)</span>,<span class="st">".png"</span><span class="op">)</span><span class="op">)</span> 
<span class="op">}</span>

<span class="co"># Render graphs</span>
<span class="va">graphs</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">seasonal_occurences</span><span class="op">$</span><span class="va">tag_name</span><span class="op">)</span>, <span class="va">season_graphs</span><span class="op">)</span></code></pre></div>
<p><img src="plots/Seasonal_occurences_of_air_traffic_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_alarms_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_animals_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_chatting_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_children_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_footsteps_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_industrial_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_marine_traffic_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_music_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_rail_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_rain_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_road_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_vegetation_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_water_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_wind_sounds.png" width="1050"><img src="plots/Seasonal_occurences_of_works_sounds.png" width="1050"></p>
</div>
</div>
</div>
<div class="section level2" number="4">
<h2 id="sound-dynamics-sunrise-study">
<span class="header-section-number">4</span> Sound dynamics: sunrise study<a class="anchor" aria-label="anchor" href="#sound-dynamics-sunrise-study"></a>
</h2>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">get_sunrise</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">pk_track</span>, <span class="va">date</span>, <span class="va">lat</span>, <span class="va">lon</span>, <span class="va">tz</span> <span class="op">=</span><span class="st">"UTC"</span><span class="op">)</span> <span class="op">{</span>
  <span class="co"># compute sunrise time from localisation and UTC time</span>
  <span class="co">#return NA if error</span>
  <span class="va">in_pk_track</span> <span class="op">=</span> <span class="va">pk_track</span>
  <span class="va">in_lat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lat</span>,<span class="fl">5</span><span class="op">)</span>
  <span class="va">in_lon</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">lon</span>,<span class="fl">5</span><span class="op">)</span>
  <span class="va">in_tz</span> <span class="op">=</span> <span class="va">tz</span>
  
  
  <span class="va">sunrise</span> <span class="op">=</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span><span class="fu">suncalc</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/suncalc/man/getSunlightTimes.html" class="external-link">getSunlightTimes</a></span><span class="op">(</span>
    date <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/date.html" class="external-link">date</a></span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,
    lat <span class="op">=</span> <span class="va">in_lat</span>,
    lon <span class="op">=</span> <span class="va">in_lon</span>,
    tz   <span class="op">=</span> <span class="va">in_tz</span>
  <span class="op">)</span><span class="op">$</span><span class="va">sunrise</span>, error<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NA</span><span class="op">)</span>

  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html" class="external-link">tribble</a></span><span class="op">(</span>
 <span class="op">~</span><span class="va">pk_track</span>, <span class="op">~</span><span class="va">sunrise</span>,
 <span class="va">in_pk_track</span>, <span class="va">sunrise</span><span class="op">)</span>
<span class="op">)</span>
<span class="op">}</span>

<span class="co"># Compute track centroid coordinates</span>
<span class="va">suncalc_prep</span> <span class="op">&lt;-</span> <span class="va">filtered_track_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html" class="external-link">bind_cols</a></span><span class="op">(</span>
  <span class="va">filtered_track_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/geos_unary.html" class="external-link">st_centroid</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="va">Y</span>, lon <span class="op">=</span> <span class="va">X</span><span class="op">)</span>
<span class="op">)</span> </code></pre></div>
<pre><code><span class="co">## Warning in st_centroid.sf(.): st_centroid assumes attributes are constant over</span>
<span class="co">## geometries of x</span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Compute sunrise hours for each track in a new dataframe</span>
<span class="va">sunrises</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">pmap_dfr</a></span><span class="op">(</span><span class="va">suncalc_prep</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pk_track</span>, date <span class="op">=</span> <span class="va">record_utc</span>, <span class="va">lat</span>, <span class="va">lon</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">st_drop_geometry</span>, <span class="va">get_sunrise</span> <span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># join sunrises to study data</span>
<span class="co"># removes records where sunrise time cannot be compute (track 265404)</span>
<span class="va">time_after_sunrise</span> <span class="op">&lt;-</span> <span class="va">suncalc_prep</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">inner_join</a></span><span class="op">(</span><span class="va">sunrises</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">sunrise</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co">#remove NAs to avoid errors later on</span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>local_time <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/hour.html" class="external-link">hour</a></span><span class="op">(</span> <span class="co"># extract hour</span>
    <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">with_tz</a></span><span class="op">(</span> <span class="co"># convert to local time</span>
      <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="va">record_utc</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="co"># convert text to date</span>
      <span class="st">"Europe/Paris"</span><span class="op">)</span><span class="op">)</span>,
    local_sunrise <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/hour.html" class="external-link">hour</a></span><span class="op">(</span> <span class="co"># extract hour</span>
    <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">with_tz</a></span><span class="op">(</span> <span class="co"># convert to local time</span>
      <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="va">sunrise</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="co"># convert text to date</span>
      <span class="st">"Europe/Paris"</span><span class="op">)</span><span class="op">)</span>,
    time_after_sunrise <span class="op">=</span> <span class="va">local_time</span> <span class="op">-</span><span class="va">local_sunrise</span>
    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span> <span class="va">all_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">pk_track</span>,<span class="va">tag_name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Joining, by = "pk_track"</span>
<span class="co">## Joining, by = "pk_track"</span></code></pre>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">time_after_sunrise</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<colgroup>
<col width="3%">
<col width="8%">
<col width="5%">
<col width="5%">
<col width="5%">
<col width="16%">
<col width="3%">
<col width="4%">
<col width="8%">
<col width="4%">
<col width="6%">
<col width="8%">
<col width="4%">
<col width="13%">
</colgroup>
<thead><tr class="header">
<th align="right">pk_track</th>
<th align="left">record_utc</th>
<th align="right">time_length</th>
<th align="right">pleasantness</th>
<th align="right">noise_level</th>
<th align="left">track_uuid</th>
<th align="right">lat</th>
<th align="right">lon</th>
<th align="left">sunrise</th>
<th align="right">local_time</th>
<th align="right">local_sunrise</th>
<th align="right">time_after_sunrise</th>
<th align="left">tag_name</th>
<th align="left">geog</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1872</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">47.38944</td>
<td align="right">0.6938955</td>
<td align="left">2017-12-14 07:38:30</td>
<td align="right">17</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="left">chatting</td>
<td align="left">POLYGON ((0.6938293 47.3893…</td>
</tr>
<tr class="even">
<td align="right">1872</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">47.38944</td>
<td align="right">0.6938955</td>
<td align="left">2017-12-14 07:38:30</td>
<td align="right">17</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="left">children</td>
<td align="left">POLYGON ((0.6938293 47.3893…</td>
</tr>
<tr class="odd">
<td align="right">1872</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">47.38944</td>
<td align="right">0.6938955</td>
<td align="left">2017-12-14 07:38:30</td>
<td align="right">17</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="left">footsteps</td>
<td align="left">POLYGON ((0.6938293 47.3893…</td>
</tr>
<tr class="even">
<td align="right">1872</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">47.38944</td>
<td align="right">0.6938955</td>
<td align="left">2017-12-14 07:38:30</td>
<td align="right">17</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="left">music</td>
<td align="left">POLYGON ((0.6938293 47.3893…</td>
</tr>
<tr class="odd">
<td align="right">1872</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">47.38944</td>
<td align="right">0.6938955</td>
<td align="left">2017-12-14 07:38:30</td>
<td align="right">17</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="left">road</td>
<td align="left">POLYGON ((0.6938293 47.3893…</td>
</tr>
<tr class="even">
<td align="right">1872</td>
<td align="left">2017-12-14 16:20:17</td>
<td align="right">62</td>
<td align="right">NA</td>
<td align="right">90.54</td>
<td align="left">f1f6d44c-1399-41fa-8cb9-8becbc43778f</td>
<td align="right">47.38944</td>
<td align="right">0.6938955</td>
<td align="left">2017-12-14 07:38:30</td>
<td align="right">17</td>
<td align="right">8</td>
<td align="right">9</td>
<td align="left">rail</td>
<td align="left">POLYGON ((0.6938293 47.3893…</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">occurences</span> <span class="op">&lt;-</span> <span class="va">time_after_sunrise</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_drop_geometry</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">tag_name</span>, <span class="va">time_after_sunrise</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"occurences"</span><span class="op">)</span>

<span class="va">time_after_sunrise_repartition</span> <span class="op">&lt;-</span> <span class="va">occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>
    <span class="va">occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">time_after_sunrise</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">occurences</span><span class="op">)</span><span class="op">)</span>,
    by <span class="op">=</span> <span class="st">"time_after_sunrise"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">occurences</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">/</span> <span class="va">total</span><span class="op">)</span>

<span class="va">time_after_sunrise_repartition</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left">tag_name</th>
<th align="right">time_after_sunrise</th>
<th align="right">occurences</th>
<th align="right">total</th>
<th align="right">percentage</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">-8</td>
<td align="right">1</td>
<td align="right">27</td>
<td align="right">3.703704</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">-7</td>
<td align="right">6</td>
<td align="right">88</td>
<td align="right">6.818182</td>
</tr>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">-6</td>
<td align="right">3</td>
<td align="right">88</td>
<td align="right">3.409091</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">-4</td>
<td align="right">2</td>
<td align="right">66</td>
<td align="right">3.030303</td>
</tr>
<tr class="odd">
<td align="left">air_traffic</td>
<td align="right">-2</td>
<td align="right">1</td>
<td align="right">38</td>
<td align="right">2.631579</td>
</tr>
<tr class="even">
<td align="left">air_traffic</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">43</td>
<td align="right">6.976744</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">time_after_sunrise_repartition</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_after_sunrise</span>, y <span class="op">=</span> <span class="va">percentage</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"circle"</span>, size <span class="op">=</span> <span class="fl">1.5</span>, colour <span class="op">=</span> <span class="st">"#112446"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
     x <span class="op">=</span> <span class="st">"Time before or after sunrise"</span>,
     y <span class="op">=</span> <span class="st">"Percentage"</span>,
     title <span class="op">=</span> <span class="st">"Hourly repartition of tags"</span>,
     subtitle <span class="op">=</span> <span class="st">"Noicecaptures tags in metropolitan France,
     2017 - 2020"</span>
   <span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">tag_name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="temporal_exploratory_analysis_files/figure-html/time-after-sunrise-graph-1.png" width="672"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sunrise_graphs</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">tag</span><span class="op">)</span> <span class="op">{</span>
  
  <span class="va">title</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Repartition of"</span>,<span class="va">tag</span>,<span class="st">"sounds around sunrise time"</span><span class="op">)</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">time_after_sunrise_repartition</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">tag_name</span> <span class="op">==</span> <span class="va">tag</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">time_after_sunrise</span>, y <span class="op">=</span> <span class="va">percentage</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="st">"circle"</span>, size <span class="op">=</span> <span class="fl">1.5</span>, colour <span class="op">=</span> <span class="st">"#112446"</span><span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
     x <span class="op">=</span> <span class="st">"Time before or after sunrise"</span>,
     y <span class="op">=</span> <span class="st">"Percentage"</span>,
     title <span class="op">=</span> <span class="va">title</span>,
     subtitle <span class="op">=</span> <span class="st">"Noicecaptures tags in metropolitan France,
     2017 - 2020"</span>
   <span class="op">)</span> <span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_smooth.html" class="external-link">geom_smooth</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"loess"</span>, se <span class="op">=</span> <span class="cn">FALSE</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour<span class="op">=</span><span class="st">"loess"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="co"># smooth curve test (see span parameter to fit more to the peak before sunrise)</span>
  <span class="co"># geom_smooth(method = "lm", formula = y ~ poly(x, 3), se = FALSE, aes(colour="Polynomial")) +</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
   <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span>
  
  <span class="co"># save graphs</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"plots/"</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"_"</span>,<span class="va">title</span><span class="op">)</span>,<span class="st">".png"</span><span class="op">)</span><span class="op">)</span> 
<span class="op">}</span>

<span class="co"># Render graphs</span>
<span class="va">graphs</span> <span class="op">&lt;-</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">seasonal_occurences</span><span class="op">$</span><span class="va">tag_name</span><span class="op">)</span>, <span class="va">sunrise_graphs</span><span class="op">)</span></code></pre></div>
<p><img src="plots/Repartition_of_air_traffic_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_alarms_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_animals_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_chatting_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_children_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_footsteps_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_industrial_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_marine_traffic_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_music_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_rail_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_rain_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_road_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_vegetation_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_water_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_wind_sounds_around_sunrise_time.png" width="1050"><img src="plots/Repartition_of_works_sounds_around_sunrise_time.png" width="1050"></p>
</div>
<div class="section level2" number="5">
<h2 id="monthly-repartition">
<span class="header-section-number">5</span> Monthly repartition<a class="anchor" aria-label="anchor" href="#monthly-repartition"></a>
</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">monthly_occurences</span> <span class="op">&lt;-</span> <span class="va">all_info</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>local_month <span class="op">=</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/month.html" class="external-link">month</a></span><span class="op">(</span> <span class="co"># extract hour</span>
    <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/with_tz.html" class="external-link">with_tz</a></span><span class="op">(</span> <span class="co"># convert to local time</span>
      <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd_hms.html" class="external-link">ymd_hms</a></span><span class="op">(</span><span class="va">record_utc</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span>, <span class="co"># convert text to date</span>
      <span class="st">"Europe/Paris"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">tag_name</span>, <span class="va">local_month</span>, <span class="va">season</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span>name <span class="op">=</span> <span class="st">"occurences"</span><span class="op">)</span>

<span class="va">tags_monthly_repartition</span> <span class="op">&lt;-</span> <span class="va">monthly_occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span>
    <span class="va">monthly_occurences</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">local_month</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>total <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">occurences</span><span class="op">)</span><span class="op">)</span>,
    by <span class="op">=</span> <span class="st">"local_month"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>percentage <span class="op">=</span> <span class="va">occurences</span> <span class="op">*</span> <span class="fl">100</span> <span class="op">/</span> <span class="va">total</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data_breaks</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span><span class="op">)</span>,  <span class="co"># Create data with breaks</span>
                          end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">6</span>, <span class="fl">9</span>, <span class="fl">12</span><span class="op">)</span>,
                          Seasons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Winter"</span>, <span class="st">"Spring"</span>, <span class="st">"Summer"</span>, <span class="st">"Autumn"</span><span class="op">)</span>, 
                                          levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Winter"</span>, <span class="st">"Spring"</span>, <span class="st">"Summer"</span>, <span class="st">"Autumn"</span><span class="op">)</span>,
                          labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Winter"</span>, <span class="st">"Spring"</span>, <span class="st">"Summer"</span>, <span class="st">"Autumn"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="va">data_breaks</span>                                       <span class="co"># Print data with breaks</span></code></pre></div>
<pre><code><span class="co">##   start end Seasons</span>
<span class="co">## 1     0   3  Winter</span>
<span class="co">## 2     3   6  Spring</span>
<span class="co">## 3     6   9  Summer</span>
<span class="co">## 4     9  12  Autumn</span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="co"># Add background colors to plot</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html" class="external-link">geom_rect</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">data_breaks</span>,
            <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>xmin <span class="op">=</span> <span class="va">start</span>,
                xmax <span class="op">=</span> <span class="va">end</span>,
                ymin <span class="op">=</span> <span class="op">-</span> <span class="cn">Inf</span>,
                ymax <span class="op">=</span> <span class="cn">Inf</span>,
                fill <span class="op">=</span> <span class="va">Seasons</span><span class="op">)</span>,
            alpha <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_fill_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Winter"</span> <span class="op">=</span> <span class="st">"white"</span>,
                               <span class="st">"Spring"</span> <span class="op">=</span> <span class="st">"green"</span>,
                               <span class="st">"Summer"</span> <span class="op">=</span> <span class="st">"yellow"</span>,
                               <span class="st">"Autumn"</span> <span class="op">=</span> <span class="st">"brown"</span>
                               <span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">tags_monthly_repartition</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">local_month</span>, y <span class="op">=</span> <span class="va">percentage</span><span class="op">)</span>,
             shape <span class="op">=</span> <span class="st">"circle"</span>, size <span class="op">=</span> <span class="fl">1.5</span>, colour <span class="op">=</span> <span class="st">"#112446"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>
    x <span class="op">=</span> <span class="st">"Month"</span>,
    y <span class="op">=</span> <span class="st">"Percentage"</span>,
    title <span class="op">=</span> <span class="st">"Monthly repartition of tags"</span>,
    subtitle <span class="op">=</span> <span class="st">"Noicecaptures tags in metropolitan France,
    2017 - 2020"</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_continuous</a></span><span class="op">(</span>breaks <span class="op">=</span> <span class="fu">scales</span><span class="fu">::</span><span class="fu"><a href="https://scales.r-lib.org/reference/breaks_pretty.html" class="external-link">pretty_breaks</a></span><span class="op">(</span><span class="op">)</span>, labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Jan"</span>,<span class="st">"Feb"</span>,<span class="st">"Apr"</span>,<span class="st">"Jun"</span>, <span class="st">"Aug"</span>, <span class="st">"Oct"</span>, <span class="st">"Dec"</span>, <span class="st">"null"</span><span class="op">)</span>, limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">tag_name</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Warning: Removed 16 rows containing missing values (geom_rect).</span></code></pre>
<p><img src="temporal_exploratory_analysis_files/figure-html/tags-monthly-repartition-graph-1.png" width="672"></p>
<pre><code><span class="co">## Warning: Removed 16 rows containing missing values (geom_rect).</span></code></pre>
<!-- TODO


- timezones : https://github.com/Ifsttar/NoiseCapture/tree/master/onomap-geoserver/geoserver/src/test/resources/org/noise_planet/noisecapturegs
  - loaded in database
  - not used because metropolitan France study only
  - intersect track geom with timezones and use timezone variable in computations ("Europe/Paris" -> tz)
- investiguate with there is doubles in tags_monthly_dynamic graph in Road March and industrial June (data related ? Agregation ?)

-->
</div>
<div class="section level2" number="6">
<h2 id="packages-citations">
<span class="header-section-number">6</span> Packages citations<a class="anchor" aria-label="anchor" href="#packages-citations"></a>
</h2>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"tidyverse"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">##   Wickham et al., (2019). Welcome to the tidyverse. Journal of Open</span>
<span class="co">##   Source Software, 4(43), 1686, https://doi.org/10.21105/joss.01686</span>
<span class="co">## </span>
<span class="co">## A BibTeX entry for LaTeX users is</span>
<span class="co">## </span>
<span class="co">##   @Article{,</span>
<span class="co">##     title = {Welcome to the {tidyverse}},</span>
<span class="co">##     author = {Hadley Wickham and Mara Averick and Jennifer Bryan and Winston Chang and Lucy D'Agostino McGowan and Romain François and Garrett Grolemund and Alex Hayes and Lionel Henry and Jim Hester and Max Kuhn and Thomas Lin Pedersen and Evan Miller and Stephan Milton Bache and Kirill Müller and Jeroen Ooms and David Robinson and Dana Paige Seidel and Vitalie Spinu and Kohske Takahashi and Davis Vaughan and Claus Wilke and Kara Woo and Hiroaki Yutani},</span>
<span class="co">##     year = {2019},</span>
<span class="co">##     journal = {Journal of Open Source Software},</span>
<span class="co">##     volume = {4},</span>
<span class="co">##     number = {43},</span>
<span class="co">##     pages = {1686},</span>
<span class="co">##     doi = {10.21105/joss.01686},</span>
<span class="co">##   }</span></code></pre>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"sf"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## To cite package sf in publications, please use:</span>
<span class="co">## </span>
<span class="co">##   Pebesma, E., 2018. Simple Features for R: Standardized Support for</span>
<span class="co">##   Spatial Vector Data. The R Journal 10 (1), 439-446,</span>
<span class="co">##   https://doi.org/10.32614/RJ-2018-009</span>
<span class="co">## </span>
<span class="co">## A BibTeX entry for LaTeX users is</span>
<span class="co">## </span>
<span class="co">##   @Article{,</span>
<span class="co">##     author = {Edzer Pebesma},</span>
<span class="co">##     title = {{Simple Features for R: Standardized Support for Spatial Vector Data}},</span>
<span class="co">##     year = {2018},</span>
<span class="co">##     journal = {{The R Journal}},</span>
<span class="co">##     doi = {10.32614/RJ-2018-009},</span>
<span class="co">##     url = {https://doi.org/10.32614/RJ-2018-009},</span>
<span class="co">##     pages = {439--446},</span>
<span class="co">##     volume = {10},</span>
<span class="co">##     number = {1},</span>
<span class="co">##   }</span></code></pre>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"hydroTSM"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## To cite hydroTSM in publications use:</span>
<span class="co">## </span>
<span class="co">##   Mauricio Zambrano-Bigiarini. (2020) hydroTSM: Time Series Management,</span>
<span class="co">##   Analysis and Interpolation for Hydrological ModellingR package</span>
<span class="co">##   version 0.6-0. URL https://github.com/hzambran/hydroTSM.</span>
<span class="co">##   DOI:10.5281/zenodo.839864.</span>
<span class="co">## </span>
<span class="co">## A BibTeX entry for LaTeX users is</span>
<span class="co">## </span>
<span class="co">##   @Manual{,</span>
<span class="co">##     title = {hydroTSM: Time Series Management, Analysis and Interpolation for Hydrological Modelling},</span>
<span class="co">##     author = {{Mauricio Zambrano-Bigiarini}},</span>
<span class="co">##     year = {2020},</span>
<span class="co">##     note = {R package version 0.6-0 . doi: https://doi.org/10.5281/zenodo.83964},</span>
<span class="co">##     url = {https://github.com/hzambran/hydroTSM},</span>
<span class="co">##   }</span>
<span class="co">## </span>
<span class="co">## I have invested an important amount of time and effort in creating</span>
<span class="co">## hydroTSM, please cite it if you use it !</span></code></pre>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/citation.html" class="external-link">citation</a></span><span class="op">(</span><span class="st">"suncalc"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## </span>
<span class="co">## To cite package 'suncalc' in publications use:</span>
<span class="co">## </span>
<span class="co">##   Benoit Thieurmel and Achraf Elmarhraoui (2019). suncalc: Compute Sun</span>
<span class="co">##   Position, Sunlight Phases, Moon Position and Lunar Phase. R package</span>
<span class="co">##   version 0.5.0. https://CRAN.R-project.org/package=suncalc</span>
<span class="co">## </span>
<span class="co">## A BibTeX entry for LaTeX users is</span>
<span class="co">## </span>
<span class="co">##   @Manual{,</span>
<span class="co">##     title = {suncalc: Compute Sun Position, Sunlight Phases, Moon Position and Lunar</span>
<span class="co">## Phase},</span>
<span class="co">##     author = {Benoit Thieurmel and Achraf Elmarhraoui},</span>
<span class="co">##     year = {2019},</span>
<span class="co">##     note = {R package version 0.5.0},</span>
<span class="co">##     url = {https://CRAN.R-project.org/package=suncalc},</span>
<span class="co">##   }</span></code></pre>
</div>
<div class="section level2" number="7">
<h2 id="reproductibility">
<span class="header-section-number">7</span> Reproductibility<a class="anchor" aria-label="anchor" href="#reproductibility"></a>
</h2>
<div class="section level3" number="7.1">
<h3 id="data-sources">
<span class="header-section-number">7.1</span> Data sources<a class="anchor" aria-label="anchor" href="#data-sources"></a>
</h3>
<p>Most of the treatment has been made within the PostGIS database.
The scripts folder contains several scripts to execute to prepare the dataset.</p>
</div>
<div class="section level3" number="7.2">
<h3 id="session-informations">
<span class="header-section-number">7.2</span> Session informations<a class="anchor" aria-label="anchor" href="#session-informations"></a>
</h3>
<pre><code><span class="co">## R version 4.1.1 (2021-08-10)</span>
<span class="co">## Platform: x86_64-w64-mingw32/x64 (64-bit)</span>
<span class="co">## Running under: Windows 10 x64 (build 19044)</span>
<span class="co">## </span>
<span class="co">## Locale:</span>
<span class="co">##   LC_COLLATE=French_France.1252  LC_CTYPE=French_France.1252   </span>
<span class="co">##   LC_MONETARY=French_France.1252 LC_NUMERIC=C                  </span>
<span class="co">##   LC_TIME=French_France.1252    </span>
<span class="co">## </span>
<span class="co">## Package version:</span>
<span class="co">##   DBI_1.1.1         dplyr_1.0.9       ggplot2_3.3.5     hydroTSM_0.6-0   </span>
<span class="co">##   lubridate_1.8.0   purrr_0.3.4       RPostgreSQL_0.7-3 scales_1.1.1     </span>
<span class="co">##   sf_1.0-3          suncalc_0.5.0     xfun_0.30         xts_0.12.1       </span>
<span class="co">##   zoo_1.8-9</span></code></pre>
</div>
<div class="section level3" number="7.3">
<h3 id="database-information">
<span class="header-section-number">7.3</span> Database information<a class="anchor" aria-label="anchor" href="#database-information"></a>
</h3>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># print software versions</span>
<span class="va">pg_version</span>  <span class="op">&lt;-</span> <span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">cache_rds</a></span><span class="op">(</span><span class="op">{</span>
  <span class="fu">RPostgreSQL</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">con</span>,statement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SELECT version();"</span><span class="op">)</span><span class="op">)</span> <span class="co"># should return PostgreSQL 10.15 or higher</span>
<span class="op">}</span>,rerun <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">database</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">pg_version</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                                                                                                                                version</span>
<span class="co">## 1 PostgreSQL 10.21 (Ubuntu 10.21-0ubuntu0.18.04.1) on x86_64-pc-linux-gnu, compiled by gcc (Ubuntu 7.5.0-3ubuntu1~18.04) 7.5.0, 64-bit</span></code></pre>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">postgis_version</span>  <span class="op">&lt;-</span> <span class="fu">xfun</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/xfun/man/cache_rds.html" class="external-link">cache_rds</a></span><span class="op">(</span><span class="op">{</span>
  <span class="fu">RPostgreSQL</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">con</span>,statement <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"SELECT postgis_full_version();"</span><span class="op">)</span><span class="op">)</span> <span class="co"># should return PostGIS 2.5 or higher</span>
<span class="op">}</span>,rerun <span class="op">=</span> <span class="va">params</span><span class="op">$</span><span class="va">database</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">postgis_version</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">##                                                                                                                                                                                            postgis_full_version</span>
<span class="co">## 1 POSTGIS="2.5.5" [EXTENSION] PGSQL="100" GEOS="3.7.1-CAPI-1.11.1 27a5e771" PROJ="Rel. 4.9.3, 15 August 2016" GDAL="GDAL 2.4.2, released 2019/06/28" LIBXML="2.9.4" LIBJSON="0.12.1" LIBPROTOBUF="1.2.1" RASTER</span></code></pre>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># close connection</span>
<span class="fu">RPostgreSQL</span><span class="fu">::</span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">con</span><span class="op">)</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Nicolas Roelandt, Pierre Aumond, Ludovic Moisan.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
